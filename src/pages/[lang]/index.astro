---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { LANGS, DEFAULT_LANG, type Lang } from "../../config/i18n";
import { HOME_MESSAGES } from "../../locales/home";
import HomePage from "../../components/home/HomePage.astro";

// Generate localized home pages for non-default languages (e.g., zh)
export function getStaticPaths() {
  return LANGS.filter((l) => l !== DEFAULT_LANG).map((lang) => ({
    params: { lang },
  }));
}

const { lang } = Astro.params as { lang?: string };
const safeLang: Lang = LANGS.includes((lang as Lang) || ("" as Lang))
  ? (lang as Lang)
  : DEFAULT_LANG;
const messages = HOME_MESSAGES[safeLang];
const BASE = import.meta.env.BASE_URL || '/';
---
<BaseLayout lang={safeLang} title="MindQuantum" description={messages.metaDescription}>
  <HomePage lang={safeLang} messages={messages} baseUrl={BASE} />
</BaseLayout>
